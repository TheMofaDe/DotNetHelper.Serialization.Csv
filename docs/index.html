<!DOCTYPE html>
<html>
<head>
    <title>DotNetHelper.Serialization.Csv</title>
</head>
<body>

    <h1 id="dotnethelper.serialization.csv">DotNetHelper.Serialization.Csv</h1>
<h4 id="dotnethelper.serialization.csv-is-a-lightweight-serialization-library-for-csv"><em>DotNetHelper.Serialization.Csv is a lightweight serialization library for csv.</em></h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Package</th>
<th style="text-align: center;">Tests</th>
<th style="text-align: center;">Code Coverage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img src="https://img.shields.io/nuget/dt/DotNetHelper.Serialization.Csv.svg?style=flat-square" alt="Build Status" /></td>
<td style="text-align: center;"><img src="https://img.shields.io/appveyor/tests/TheMofaDe/DotNetHelper.Serialization.Csv.svg?style=flat-square" alt="Build Status" /></td>
<td style="text-align: center;"><a href="https://codecov.io/gh/TheMofaDe/DotNetHelper.Serialization.Csv"><img src="https://codecov.io/gh/TheMofaDe/DotNetHelper.Serialization.Csv/branch/master/graph/badge.svg" alt="codecov" /></a></td>
</tr>
</tbody>
</table>
<h2 id="how-to-use">How to use</h2>
<pre><code class="language-csharp">var csvSerializer = new DataSourceCsv(); 
</code></pre>
<p>the class DataSourceCSV have access to the following apis</p>
<pre><code class="language-csharp">        
        //Serialize an object to the provided stream
        void SerializeToStream&lt;T&gt;(T obj, Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false) where T : class;
        void SerializeToStream(object obj, Type type, Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false);

        //Serialize an object to a new instance of a stream and returns the stream
        Stream SerializeToStream&lt;T&gt;(T obj, int bufferSize = 1024) where T : class;
        Stream SerializeToStream(object obj, Type type,  int bufferSize = 1024);

        //Serialize an object to a string
        string SerializeToString(object obj);
        string SerializeToString&lt;T&gt;(T obj) where T : class;

        //Retrieve a list of either generics,objects,or dynamics from either a stream or string
        List&lt;dynamic&gt; DeserializeToList(string content);
        List&lt;dynamic&gt; DeserializeToList(Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false);
        List&lt;T&gt; DeserializeToList&lt;T&gt;(string content) where T : class;
        List&lt;T&gt; DeserializeToList&lt;T&gt;(Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false) where T : class;
        List&lt;object&gt; DeserializeToList(string content, Type type);

        //Retrieve a dynamic object from String or stream
        dynamic Deserialize(string content);
        dynamic Deserialize(Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false);

        //Retrieve a strongly type from a string or stream
        T Deserialize&lt;T&gt;(string content) where T : class;
        T Deserialize&lt;T&gt;(Stream stream, int bufferSize = 1024, bool leaveStreamOpen = false) where T : class;
        
        //Retrieve a object from a string or stream
        object Deserialize(string content, Type type);        
        object Deserialize(Stream stream, Type type, int bufferSize = 1024, bool leaveStreamOpen = false);
</code></pre>
<h2 id="serialization-with-files">Serialization with Files</h2>
<h4 id="this-example-is-going-to-reference-a-employee-class-and-two-global-variables">This example is going to reference a employee class and two global variables</h4>
<pre><code class="language-csharp">public class Employee {
            public string FirstName { get; set; } = &quot;Jon&quot;;
            public string LastName { get; set; } = &quot;Last&quot;;
            public int Id { get; set; }
}

            var csvSerializer = new DataSourceCsv();
            var employee = new Employee {Id = 1};
</code></pre>
<h4 id="write-single-object-to-file">Write single object to file</h4>
<pre><code class="language-csharp">            using (var fileStream = new FileStream($@&quot;C:\Temp\employee.csv&quot;, FileMode.Create, FileAccess.Write))
                   csvSerializer.SerializeToStream(employee, fileStream);
</code></pre>
<h4 id="write-list-of-objects-to-file">Write list of objects to file</h4>
<pre><code class="language-csharp">            using (var fileStream = new FileStream($@&quot;C:\Temp\employeeList.csv&quot;, FileMode.Create, FileAccess.Write))
                csvSerializer.SerializeListToStream(new List&lt;Employee&gt;(){employee}, fileStream);
</code></pre>
<h4 id="read-single-object-from-file">Read single object from file</h4>
<pre><code class="language-csharp">             var employeeFromFile = csvSerializer.Deserialize&lt;Employee&gt;(new StreamReader($@&quot;C:\Temp\employee.csv&quot;).BaseStream);
</code></pre>
<h4 id="read-list-of-objects-from-file">Read list of objects from file</h4>
<pre><code class="language-csharp">            var employeesFromFile = csvSerializer.DeserializeToList&lt;Employee&gt;(new StreamReader($@&quot;C:\Temp\employeeList.csv&quot;).BaseStream);
</code></pre>
<h2 id="serialization-with-json">Serialization with JSON</h2>
<p><a href="https://github.com/TheMofaDe/DotNetHelper.Serialization.Csv">JSON LINK</a></p>
<!-- Links. -->


</body>
</html>